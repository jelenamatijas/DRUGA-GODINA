From: kormang@hotmail.rs
To: alex.srbac@gmail.com; darko_aleksic09@yahoo.com
Subject: Јава усмени, други задатак
Date: Thu, 15 Aug 2013 13:05:47 +0200


Овако би одприлике гласио задатак:


Приказати стање меморије у тренуцима означим са ознакама 1, 2.
Машина има хип величине 1500МB.



public class Mainy{

      int id;
      
      double[] doubles = new double[10 000 000];

      long[] longs = new long[6 000 000];

      Mainy[] mys = new Mainy[3];

      Mainy m;

      Dumb d;

      public Mainy(Main m){

            this.m = m;

            if(m!=null)
		 id = m.id + 1;
   
   }
 
     
      public static void main(String[] args){

            Mainy m0 = new Mainy(null);

            Mainy m1 = new Mainy(m0);

            Mainy m2 = new Mainy(m1);

            Mainy m3 = new Mainy(m2);

            Mainy m4 = m3;

            Mainy m5 = new Mainy(m0);


            Mainy[] ms = new Mainy[3];

            ms[0] = new Mainy(m2);

            ms[1] = new Mainy(m3);

            ms[2] = new Mainy(m2);

            m1 = m2 = m3 = m5 = null;

            System.gc();   //1                 //pozivanje  garbage collectora

            ms[0] = new Mainy(ms[0]);

            ms[1] = new Mainy(ms[1]);

            ms[2] = new Mainy(ms[2]);

            ms[2].m = ms[0];

            m3 = new Mainy(ms[0] = null);

            ms[0] = new Mainy(ms[0]);

            System.gc();  //2

            }

       }


class Dumb {

  float[] flaots = new float[20 000 000];

  int[] ints = new int[40 000 000];


}







Е сад о чему је ријеч. Ја сам погријешио што прво нисам израчунао колико један објекат Mainy заузима хипа. 
Ја то нисам рачунао јер сам перфекциониста и урачунавао сам по 4 бајта за сваку референцу и онда ми je било пре компликовано 
да рачунам колико ће највише објеката стати на хип. 
А на референцама (које заузимају по 4 бајта) није акценат нега на низовима лонгова и 
даблова који заузимају доста меморије. Низови флоутова и интова не заузимају ништа, 
јер имамо само референцу на Dumb објекат али не и сам тај објекат. 
Дакле имамо 6 милиона лонгова и 6 милиона даблова. то је 16х8 милиона бајтова 
то је 128 милиона бајтова. Како имамо 1500 милиона бајтова на располагању, можемо креирати 
највише 11 објеката (ја као перфекциониста сам још размишљао да ли заиста рачунати да имамо 
1500 милиона бајтова, јер је 1kB = 1024B умјесто 1000B, a 1 КiB = 1000B (kibi byte), и то томе не мојте размишљати, 
него само размипљајте у милионима бајтова као што ја овде пишем).

Код позивања System.gc(), препостаљамо да ће се он одмах извршити и све очистити, иако је он засебан тред и питање је кад ће 
се успјети покренути.
Дакле треба први пратити шта се дешава и шта на шта референцира и то тако цртати и графички представити. Kад се позове ГК, 
треба да цртежу уочити све оне објекте на које више нико не показује и прецртати их.
А да се не би зезнули као ја, претходно израчунајте да може стати х објеката у меморију (у овом случају 11), па ћете онда сконтати да до 
ознаке 2 неће ни доћи јер ће доћи до пуцања меморије у линији прије тога.

Ја сам овде све писао одприлике. Можда сам чак погрешно израчунао да је у питању максималних 11 објеката.

Надам се на основу овог мог примјера може стећи нека представа о томе како тај задатак изгледа.
